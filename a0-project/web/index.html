<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agri365 Pro | Smart Agricultural Interface</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar animate-fade-in">
        <div class="logo">
            <i class="fas fa-seedling"></i> Agri365
        </div>
        <ul class="nav-links">
            <li class="nav-item"><a href="#" class="nav-link active" onclick="switchTab('dashboard')"><i
                        class="fas fa-grid-2"></i> Dashboard</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="switchTab('pests')"><i class="fas fa-bug"></i>
                    Pest ID</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="switchTab('weather')"><i
                        class="fas fa-cloud-sun"></i> Weather</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="switchTab('market')"><i
                        class="fas fa-chart-line"></i> Market</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="switchTab('soil')"><i class="fas fa-flask"></i>
                    Soil Health</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="switchTab('diagnostics')"><i
                        class="fas fa-stethoscope"></i> Diagnostics</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="switchTab('community')"><i
                        class="fas fa-users"></i> Community</a></li>
        </ul>
        <div class="api-status">
            <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 5px;">API INTERFACE STATUS</div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <span style="width: 8px; height: 8px; border-radius: 50%; background: var(--success);"></span>
                <span id="api-status-text">Connected to Remote API</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <header class="top-bar animate-fade-in" style="animation-delay: 0.1s">
            <div class="search-bar-wrap" style="position: relative;">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="global-search" placeholder="Search crops, pests, or market trends..."
                        oninput="handleGlobalSearch(this.value)" autocomplete="off">
                </div>
                <div id="search-results-list" class="search-results-dropdown" style="display: none;"></div>
            </div>
            <div class="location-widget" onclick="requestLiveLocation()"
                style="cursor: pointer; background: var(--card-bg); padding: 8px 15px; border-radius: 12px; border: 1px solid var(--glass-border); display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-map-marker-alt" style="color: var(--danger);"></i>
                <span id="current-location-text">Get Live Location</span>
            </div>
            <div class="user-profile">
                <div class="notifications">
                    <i class="far fa-bell" style="font-size: 20px; color: var(--text-muted); cursor: pointer;"></i>
                </div>
                <div class="user-avatar"></div>
                <div class="user-info">
                    <div style="font-weight: 600; font-size: 14px;">Demo Farmer</div>
                    <div style="font-size: 12px; color: var(--text-muted);">Pro account</div>
                </div>
            </div>
        </header>

        <section id="dashboard-view" class="animate-fade-in" style="animation-delay: 0.2s">
            <div class="dashboard-grid">
                <!-- Weather Overview -->
                <div class="card weather-card">
                    <div class="weather-info">
                        <div class="card-title">REAL-TIME WEATHER <i class="fas fa-cloud-sun"></i></div>
                        <h1 id="city-name">Pune, Maharashtra</h1>
                        <h2 id="temp-display">28°C</h2>
                        <p id="weather-desc">Partly Cloudy • Humidity: 65%</p>
                        <div class="weather-details">
                            <div class="weather-stat">
                                <div style="font-size: 12px; opacity: 0.7;">WIND</div>
                                <div style="font-weight: 600;">12 km/h</div>
                            </div>
                            <div class="weather-stat">
                                <div style="font-size: 12px; opacity: 0.7;">RAINFALL</div>
                                <div style="font-weight: 600;">0 mm</div>
                            </div>
                            <div class="weather-stat">
                                <div style="font-size: 12px; opacity: 0.7;">UV INDEX</div>
                                <div style="font-weight: 600;">Low (2)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Soil Health -->
                <div class="card">
                    <div class="card-title">SOIL HEALTH <i class="fas fa-leaf"></i></div>
                    <div style="display: flex; flex-direction: column; gap: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>Nitrogen</span>
                            <div
                                style="width: 100px; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">
                                <div
                                    style="width: 80%; height: 100%; background: var(--primary-light); border-radius: 4px;">
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>Phosphorus</span>
                            <div
                                style="width: 100px; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">
                                <div style="width: 45%; height: 100%; background: var(--warning); border-radius: 4px;">
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>pH Level</span>
                            <span style="font-weight: bold; color: var(--primary-light);">6.5 (Optimal)</span>
                        </div>
                        <button class="btn-api" onclick="fetchSoilData()">Latest Analysis</button>
                    </div>
                </div>

                <!-- Market Prices -->
                <div class="card" style="grid-column: span 2;">
                    <div class="card-title">MARKET PRICES (ONLINE FEED) <i class="fas fa-chart-line"></i></div>
                    <table class="market-table">
                        <thead>
                            <tr>
                                <th>COMMODITY</th>
                                <th>PRICE (INR)</th>
                                <th>CHANGE</th>
                                <th>VOLUME</th>
                            </tr>
                        </thead>
                        <tbody id="market-prices-body">
                            <!-- Populated by JavaScript -->
                            <tr>
                                <td>Wheat</td>
                                <td>₹2,500/q</td>
                                <td class="price-up">+1.2%</td>
                                <td>24.5k tons</td>
                            </tr>
                            <tr>
                                <td>Rice (Basmati)</td>
                                <td>₹5,500/q</td>
                                <td class="price-up">+0.8%</td>
                                <td>18.2k tons</td>
                            </tr>
                            <tr>
                                <td>Mustard</td>
                                <td>₹5,200/q</td>
                                <td class="price-down">-0.5%</td>
                                <td>12.1k tons</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Pest Identification Service -->
                <div class="card">
                    <div class="card-title">PEST ID INTERFACE <i class="fas fa-eye"></i></div>
                    <div style="text-align: center; padding: 20px;">
                        <input type="file" id="pest-upload" style="display: none;" accept="image/*"
                            onchange="handleFileUpload(event)">

                        <div id="pest-preview-container" class="preview-box"
                            onclick="document.getElementById('pest-upload').click()">
                            <img id="pest-preview" src="https://cdn-icons-png.flaticon.com/512/811/811467.png"
                                alt="Upload">
                            <video id="webcam-view" autoplay playsinline
                                style="display: none; width: 100%; height: 100%; border-radius: 12px; object-fit: cover;"></video>
                            <div id="upload-overlay">
                                <i class="fas fa-camera"></i>
                            </div>
                        </div>

                        <div class="control-buttons" style="display: flex; gap: 10px; margin-top: 15px;">
                            <button id="scan-btn" class="btn-primary" style="flex: 2;"
                                onclick="startAnalysis()">Analysis Disease</button>
                            <button id="webcam-btn" class="btn-secondary" style="flex: 1;" onclick="toggleWebcam()"><i
                                    class="fas fa-video"></i></button>
                        </div>
                    </div>

                    <div id="pest-result" class="result-panel" style="display: none;">
                        <div class="result-header">
                            <i class="fas fa-check-circle"></i>
                            <div>Match: <span id="identified-pest-name">--</span></div>
                        </div>
                        <div class="confidence">Confidence: <span id="confidence-val">94%</span></div>
                        <div class="recommendation-box">
                            <strong>RECOMMENDATION:</strong>
                            <div id="pest-recommendation">Processing...</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Detail Info Modal -->
        <div id="detail-modal" class="modal-overlay" style="display: none;">
            <div class="detail-content card">
                <div class="modal-close" onclick="closeModal('detail-modal')"><i class="fas fa-times"></i></div>
                <div id="modal-content-area"></div>
            </div>
        </div>

        <!-- Scanner Overlay Modal -->

        <!-- Scanner Overlay Modal -->
        <div id="scanner-modal" class="modal-overlay" style="display: none;">
            <div class="scanner-content">
                <div class="scanner-frame">
                    <div id="scanner-view-container"></div>
                    <div class="scan-line"></div>
                </div>
                <div class="analysis-status">
                    <h3>AI System Analyzing Health...</h3>
                    <div id="status-steps">
                        <div class="step"><i class="fas fa-circle-notch fa-spin"></i> Fetching Crop Data...</div>
                    </div>
                    <div class="progress-bar-container">
                        <div id="analysis-progress" class="progress-bar"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <style>
        .btn-api {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 10px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-api:hover {
            background: var(--primary-light);
        }

        .preview-box {
            width: 100%;
            height: 200px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--glass-border);
        }

        .preview-box img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        #upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: 0.3s;
        }

        .preview-box:hover #upload-overlay {
            opacity: 1;
        }

        #upload-overlay i {
            font-size: 32px;
            color: white;
        }

        .btn-primary {
            background: var(--primary-light);
            border: none;
            color: white;
            padding: 12px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
        }

        .result-panel {
            margin-top: 15px;
            padding: 15px;
            background: rgba(34, 197, 94, 0.1);
            border-radius: 12px;
            border: 1px solid var(--success);
            text-align: left;
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .confidence {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        .recommendation-box {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 8px;
            font-size: 13px;
        }

        /* Modal Scanner Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.95);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scanner-content {
            width: 90%;
            max-width: 500px;
            text-align: center;
        }

        .scanner-frame {
            position: relative;
            width: 100%;
            aspect-ratio: 1;
            border: 4px solid var(--primary-light);
            border-radius: 24px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 0 30px rgba(76, 175, 80, 0.3);
        }

        #scanner-view-container {
            width: 100%;
            height: 100%;
        }

        #scanner-view-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(to right, transparent, var(--success), transparent);
            box-shadow: 0 0 15px var(--success);
            animation: scanMove 2s linear infinite;
        }

        @keyframes scanMove {
            0% {
                top: 0;
            }

            50% {
                top: 100%;
            }

            100% {
                top: 0;
            }
        }

        .progress-bar-container {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-bar {
            width: 0%;
            height: 100%;
            background: var(--success);
            transition: width 0.3s;
        }

        .step {
            margin-top: 15px;
            font-size: 14px;
            color: var(--primary-light);
        }

        .api-status {
            margin-top: auto;
            border-top: 1px solid var(--glass-border);
            padding-top: 20px;
        }

        main {
            transition: all 0.5s ease;
        }
    </style>

    <script src="script.js"></script>
</body>

</html>